#!/usr/local/bin/dyalogscript

ex  ← ⊃⎕NGET './input/08e.txt' 1
inp ← ⊃⎕NGET './input/08p.txt' 1

⍝ Part 1
⎕← {
    (h w)←⍴⍵
    f←{{⍵/⍨{∧/(h w≥⍵),1≤⍵}¨⍵}⊃,/{⍵{⍺+⍥⊆⍵~⊂0 0}¨↓∘.-⍨⍵}⍵}
    ≢∪⊃,/⍵∘(f∘⍸⍤∊)¨'.'~⍨∪∊⍵
}↑inp

⍝ Part 2
⎕← {
    (h w)←⍴⍵
    filter←{⍵/⍨{∧/(h w≥⍵),1≤⍵}¨⍵}
    f←{filter ⊃,/{⍵{⍺+⍥⊆⍵}¨{⊃,/⊃,/⍵}¨{{+\¨(⊂⊂⍵)/⍨¨⌊/⌈h w÷1⌈|⍵}¨¨⍵}↓∘.-⍨⍵}⍵}

    ≢∪⊃,/⍵∘(f∘⍸⍤∊)¨'.'~⍨∪∊⍵
}↑inp

